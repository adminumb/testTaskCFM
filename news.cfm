<!---Get news years--->
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>HD Street Concert Band - News</title>
<link href="/cfTraining/styles/style.css" rel="stylesheet" type="text/css" media="screen" />
<link href="/cfTraining/styles/hdStreet.css" rel="stylesheet" type="text/css" media="screen" />

</head>

<style >
	textarea{
		width:500px;
		height:300px;
	}
table {
font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
font-size: 14px;
text-align: left;
border-collapse: collapse;
border-radius: 20px;
box-shadow: 0 0 0 10px #F2906B;
color: #452F21;

}
th {
padding: 10px 8px;
background: white;
}
table th:first-child {
border-top-left-radius: 20px;
}
table th:last-child {
border-top-right-radius: 20px;
}
td {
border-top: 10px solid #F2906B;
padding: 8px;
background: white;

}

table td:first-child {
border-bottom-left-radius: 20px;
}
table td:last-child {
border-bottom-right-radius: 20px;
}
</style>

<body>
 <header class="header">
      <div class="container">
          <div class="header__inner">
          <a class="logo" href="#">
          <img src="data:image/png;base64,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" width="200" height="100" alt="logo">
          </a>
          <nav class="menu">
              <ul class="menu__list">
                <li class="menu__item"><a class="menu__list-link" href="registration.cfm">New Task</a></li>
      <li class="menu__item"><a class="menu__list-link" href="news.cfm">Tasks list</a></li>
            <li class="menu__item"><a class="menu__list-link" href="login.cfm">Login</a></li>

              </ul>
          </nav>
          </div>
      </div>
  </header>
  
  
  
  <div id="wrapper">

  <div id="pageBody">
    <div id="calendarContent">
<!---Chapter 4 - Erase from here--->

	<cfif isDefined('url.newsID')>
		
		<cfquery datasource="mysqBD" name="singleNews">
			select descr, title, time, result, name, task_id
			from general_info
			inner join result_tb using(result_id)
			inner join user using(user_id)
			where task_id =#url.newsID#
		</cfquery>
		
		
		<cfoutput >
		         <h2>
		         	YOUR TICKET
		         </h2>
			<table  >
				<tr>
					<th >НАЗВАНИЕ</th>
					<th >#singleNews.title#</th>

				</tr>
				<tr>
					<th >ID</th>
					<th >crm#singleNews.task_id#</th>

				</tr>
					<tr>
					<th >СОТРУДНИК</th>
					<th >#singleNews.name#</th>

				</tr>
						<tr>
					<th >ДАТА ТИКЕТА</th>
					<th >#dateFormat(singleNews.time, 'mmm, dd,yyy')#</th>

				</tr>
				<tr>
					<th >ОПИСАНИЕ</th>
					<th >РЕЗУЛЬТАТ</th>

				</tr>
				
				<tr>
					<td >#singleNews.descr#</td>
					<td>#singleNews.result#</td>
				</tr>
			</table>
			<br>
			<a href="news.cfm?change=#singleNews.task_id#"> РЕДАКТИРОВАТЬ </a>

		</cfoutput>
		
				<cfelseif isDefined('url.change') >
					<cfquery datasource="mysqBD" name="qq">
			select descr, title, time, result, name, task_id,result_id
			from general_info
			inner join result_tb using(result_id)
			inner join user using(user_id)
			where task_id =#url.change#
		</cfquery>
		<cfquery datasource="mysqBD" name="result">
			select result, result_id from result_tb
		</cfquery>
                   
                   <!--- Валидация на форму--->

<cfif structKeyExists(form, 'changeForm')>
	 <cfset changeErr=Arraynew(1)/>
	 	<!--- Валидация имени--->
	<cfif form.title_change EQ ''>
    	<cfset arrayAppend(changeErr, 'Пожалуйста задайте название')/>
    </cfif> 	
	 	
    
    <cfif form.changeDesc EQ ''>
    	<cfset arrayAppend(changeErr, 'Задайте последовательность теста')/>
    </cfif>
    
    <cfif form.changeResult EQ '0'>
    	<cfset arrayAppend(changeErr, 'Установите результат теста ')/>
    </cfif>
   
   
   	<cfquery datasource='mysqBD'>
    		
    		update general_info
    		set comment='#form.changeComment#', title='#form.title_change#', descr='#form.changeDesc#',
    		 result_id='#form.changeResult#' where task_id='#qq.task_id#';
    		</cfquery>
      	<cflocation url="news.cfm" >

	</cfif>
                   
                   
                   <cfoutput >
                 
<cfform id="frm_editUser">
			<fieldset>
				<legend>Your ticket</legend>
			
				
				<dl>
					<dt><label >НАЗВАНИЕ</label></dt>
					<dd><cfinput name="title_change" id="title_change" value="#qq.title#" required="true" message="Пожалуйста введите название" /></dd>
					<dt><label for="fld_userLastName">ОПИСАНИЕ</label></dt>
					<dd><cftextarea name="changeDesc" value="#qq.descr#" id="changeDesc" required="true" message="Пожалуйста введите описание" ></cftextarea></dd>

					<dt><label >РЕЗУЛЬТАТ</label></dt>
					<dd>
							<cfselect name="changeResult" id="changeResult" query="result" value="result_id" display="result" queryposition="below" required="true" message="Пожалуйста задайте результат" >
								<option value='#result.result_id#'>#result.result#</option>
								
							</cfselect>
						</dd>
					<dd>
						
					</dd>
					<!---Comment Textarea--->
					<dt><label for="fld_userComment">Comment</label></dt>
					<dd><cftextarea name="changeComment" id="changeComment" ></cftextarea></dd>
				</dl>
				<!---Submit button--->
				<input type="submit" name="changeForm" id="changeForm" value="Update" />
			</fieldset>
		</cfform>
                   </cfoutput>
		
		<cfelseif isDefined('url.year') >
		
	
		   	<cfquery datasource="mysqBD" name="yearPage">
			select descr, title, time, user, result
			from general_info
			inner join result_tb using(result_id)
			where year(time) =#url.year#
		</cfquery>
		
		
		   <cfoutput >
		   <h1>
		   	ТУТ БУДЕТ АРХИВ ЗА
		   	   	#url.year# ГОД
		   </h1>
		
		   		   	   </cfoutput> 

		   <table >
	
<cfoutput query="yearPage" >

	 <tr>
	 	<td >
	 		#dateFormat(time, 'mmm dd yyyy')# 
	 	</td>
	 	<td >
	 		#title# 
	 	</td>
	 	<td >
	 		#descr#
	 	</td>
	 </tr>
</cfoutput>


</table>
		<cfelse>

	<cfquery datasource="mysqBD" name="rsAllNews">
		select title, time, descr,task_id
		from general_info
			
		</cfquery>
      <table>
		<cfoutput query="rsAllNews" >
			<tr>
				<td >
					#time#
				</td>
				<td >
					#title#
				</td>
				<td >
					<a href="news.cfm?newsID=#task_id#"> Узнать больше </a>
						
					</a>
				</td>
			</tr>
			
		</cfoutput>
		

	
		<h1>Список задач</h1>
      </table>	
    </cfif>
      <!---Chapter 4 - To here--->
</div>

    <div id="calendarSideBar">
<h1> АРХИВЫ</h1>
<cfquery datasource="mysqBD" name="news">
         select time, task_id
         from general_info	
</cfquery>
<table >
	
<cfoutput query="news" >
	<cfset year=#dateFormat(time, 'yyyy')#>

	    <tr>
	    	<td >
	    		<a href="news.cfm?year=#year#">
	    			#dateFormat(time, 'mmm dd yyyy')#
	    		</a>
	    	</td>
	    </tr>
</cfoutput>
</table>
    
      <p class="alignRight">&nbsp;</p>
</div>
  </div>
  <div id="footer">
    <p>&copy; My todo list</p>
  </div>
</div>
</body>
</html>
